-- =============================================================================
-- Diagram Name: Transcomadv
-- Created on: 13/10/2018 1:12:31 a. m.
-- Diagram Version: 
-- =============================================================================


CREATE TABLE "Administrador" (
	"_id" SERIAL,
	"_nombre" varchar(25) NOT NULL,
	"_correo" varchar(30),
	"_password" varchar(10),
	"_fechaRegistro" int4,
	PRIMARY KEY("_id")
);

CREATE TABLE "Cliente" (
	"_id" SERIAL,
	"_nombre" varchar(25) NOT NULL,
	"_correo" varchar(30),
	"_password" varchar(10),
	"_fechaRegistro" int4,
	"_fxAdminCliente" int4 NOT NULL,
	PRIMARY KEY("_id")
);

CREATE TABLE "Almacen" (
	"_id" SERIAL,
	"_nombreAlmacen" varchar(25) NOT NULL,
	PRIMARY KEY("_id")
);

CREATE TABLE "Entrada" (
	"_id" SERIAL,
	"_fechaEntrada" date NOT NULL,
	"_fkAlmacenEntrada" int4 NOT NULL,
	PRIMARY KEY("_id")
);

CREATE TABLE "Salida" (
	"_id" SERIAL,
	"_fechaSalida" date NOT NULL,
	"_fkAlmacenSalida" int4,
	PRIMARY KEY("_id")
);

CREATE TABLE "Pedido" (
	"_id" SERIAL,
	"_fechaSolicitud" date NOT NULL,
	"_fechaEntrega" date NOT NULL,
	"_estadoPedido" varchar,
	"_destinatario" int4,
	"_fkAlmacenPedido" int4,
	PRIMARY KEY("_id")
);

CREATE TABLE "Producto" (
    "_id" SERIAL,
	"_descripcion" varchar(50),
	"_lote" varchar(50),
	"_estadoCalidad" varchar(50),
	"_disponible" bool NOT NULL,
	"_fkEntradaProducto" int4,
	"_fkSalidaProducto" int4,
	"_fkPedidoProducto" int4,
	"_fkClienteProducto" int4,
	PRIMARY KEY("_id")
);


ALTER TABLE "Cliente" ADD CONSTRAINT "Ref_Cliente_to_Administrador" FOREIGN KEY ("_fxAdminCliente")
	REFERENCES "Administrador"("_id")
	MATCH SIMPLE
	ON DELETE NO ACTION
	ON UPDATE NO ACTION
	NOT DEFERRABLE;

ALTER TABLE "Entrada" ADD CONSTRAINT "Ref_Entrada_to_Almacen" FOREIGN KEY ("_fkAlmacenEntrada")
	REFERENCES "Almacen"("_id")
	MATCH SIMPLE
	ON DELETE NO ACTION
	ON UPDATE NO ACTION
	NOT DEFERRABLE;

ALTER TABLE "Salida" ADD CONSTRAINT "Ref_Salida_to_Almacen" FOREIGN KEY ("_fkAlmacenSalida")
	REFERENCES "Almacen"("_id")
	MATCH SIMPLE
	ON DELETE NO ACTION
	ON UPDATE NO ACTION
	NOT DEFERRABLE;

ALTER TABLE "Pedido" ADD CONSTRAINT "Ref_Pedido_to_Almacen" FOREIGN KEY ("_fkAlmacenPedido")
	REFERENCES "Almacen"("_id")
	MATCH SIMPLE
	ON DELETE NO ACTION
	ON UPDATE NO ACTION
	NOT DEFERRABLE;

ALTER TABLE "Producto" ADD CONSTRAINT "Ref_Producto_to_Entrada" FOREIGN KEY ("_fkEntradaProducto")
	REFERENCES "Entrada"("_id")
	MATCH SIMPLE
	ON DELETE NO ACTION
	ON UPDATE NO ACTION
	NOT DEFERRABLE;

ALTER TABLE "Producto" ADD CONSTRAINT "Ref_Producto_to_Salida" FOREIGN KEY ("_fkSalidaProducto")
	REFERENCES "Salida"("_id")
	MATCH SIMPLE
	ON DELETE NO ACTION
	ON UPDATE NO ACTION
	NOT DEFERRABLE;

ALTER TABLE "Producto" ADD CONSTRAINT "Ref_Producto_to_Pedido" FOREIGN KEY ("_fkPedidoProducto")
	REFERENCES "Pedido"("_id")
	MATCH SIMPLE
	ON DELETE NO ACTION
	ON UPDATE NO ACTION
	NOT DEFERRABLE;

ALTER TABLE "Producto" ADD CONSTRAINT "Ref_Producto_to_Cliente" FOREIGN KEY ("_fkClienteProducto")
	REFERENCES "Cliente"("_id")
	MATCH SIMPLE
	ON DELETE NO ACTION
	ON UPDATE NO ACTION
	NOT DEFERRABLE;


